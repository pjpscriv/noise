<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Canvas</title>
	<style type="text/css">
		html, body {
			margin: 0px;
			background-color: #000000;
			width: 100%;
			height: 100%
			
		}

		body {
			overflow: hidden;
		}

		#canvas {

		}
	</style>
	<!-- <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> -->
</head>

<body>
	<canvas id='canvas'></canvas>
</body>
<script type="text/javascript">
	

    async function setSize() {

        var w = document.body.clientWidth;
        var h = document.body.clientHeight;

        canvas.height = h;
        canvas.width = w;

        drawAll();
    }



	async function drawAll() {

		var start = Date.now()

		const canvas = document.getElementById('canvas');
		const ctx = canvas.getContext('2d');

		var w = document.body.clientWidth;
		var h = document.body.clientHeight;

		// canvas.height = h;
		// canvas.width = w;

		console.log(w);
		console.log(h);

		var p = 4;
		var s = 100;
		var go = false;
		var step = p * 4;

		for (var j=0;j<h;j+=p) {
			p = p
			for (var i=0;i<w;i+=p) {
				ctx.fillStyle = '#' + Math.random().toString(16).slice(-6);
				ctx.fillRect(i, j, p, p);
			}
			if (j % step === 0) {
				await sleep(0);
			}
		}
		console.log('done in',Date.now()-start,'ms');
	}
	

	function drawStart() {
		const canvas = document.getElementById('canvas');
		const ctx = canvas.getContext('2d');

		var w = document.body.clientWidth;
		var h = document.body.clientHeight;

		canvas.height = h;
		canvas.width = w;

		console.log(w);
		console.log(h);

		var p = 2;
		var i = 0;
		var j = 0;

		drawStep(ctx,p,i,j,w,h)
	}


	async function drawStep(ctx,p,i,j,w,h) {
		// Draw
		ctx.fillStyle = '#' + Math.random().toString(16).slice(-6);
		ctx.fillRect(i, j, p, p);
		await sleep(0);	

		// Recurse
		if (i<w) {
			drawStep(ctx,p,i+p,j,w,h);
		} else if (j<h) {
			drawStep(ctx,p,0,j+p,w,h);
		} else {
			console.log('Done.')
		}
	}


	function sleep(ms) {
		return new Promise(resolve => setTimeout(resolve, ms));
	}
	



	window.onresize = setSize;
	window.onload   = setSize;
	window.onclick  = drawAll;

</script>
</html>